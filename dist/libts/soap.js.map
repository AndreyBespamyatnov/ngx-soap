{"version":3,"sources":["../../libts/soap.ts"],"names":[],"mappings":"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","file":"soap.js","sourceRoot":"","sourcesContent":["/*\n * Copyright (c) 2011 Vinay Pulim <vinay@milewise.com>\n * MIT Licensed\n */\n\n\"use strict\";\n\nvar Client = require('./client').Client,\n  Server = require('./server').Server,\n  HttpClient = require('./http'),\n  security = require('./security'),\n  passwordDigest = require('./utils').passwordDigest,\n  wsdl = require('./wsdl'),\n  WSDL = require('./wsdl').WSDL;\n\nfunction createCache() {\n  var cache: any = {};\n  return function (key:any, load:any, callback:any) {\n    if (!cache[key]) {\n      load(function (err:any, result:any) {\n        if (err) {\n          return callback(err);\n        }\n        cache[key] = result;\n        callback(null, result);\n      });\n    } else {\n      process.nextTick(function () {\n        callback(null, cache[key]);\n      });\n    }\n  };\n}\nvar getFromCache = createCache();\n\nfunction _requestWSDL(url:any, options:any, callback:any) {\n  if (typeof options === 'function') {\n    callback = options;\n    options = {};\n  }\n  var openWsdl = wsdl.open_wsdl.bind(null, url, options);\n\n  if (options.disableCache === true) {\n    openWsdl(callback);\n  } else {\n    getFromCache(url, openWsdl, callback);\n  }\n}\n\nfunction createClient(url: any, options:any, callback:any, endpoint?:any) {\n  if (typeof options === 'function') {\n    endpoint = callback;\n    callback = options;\n    options = {};\n  }\n  endpoint = options.endpoint || endpoint;\n  _requestWSDL(url, options, function(err:any, wsdl:any) {\n    callback(err, wsdl && new Client(wsdl, endpoint, options));\n  });\n}\n\nfunction listen(server:any, pathOrOptions:any, services:any, xml:any) {\n  var options: any = {},\n    path = pathOrOptions,\n    uri = null;\n\n  if (typeof pathOrOptions === 'object') {\n    options = pathOrOptions;\n    path = options.path;\n    services = options.services;\n    xml = options.xml;\n    uri = options.uri;\n  }\n\n  var wsdl = new WSDL(xml || services, uri, options);\n  return new Server(server, path, services, wsdl, options);\n}\n\nexports.security = security;\nexports.BasicAuthSecurity = security.BasicAuthSecurity;\nexports.WSSecurity = security.WSSecurity;\nexports.WSSecurityCert = security.WSSecurityCert;\nexports.ClientSSLSecurity = security.ClientSSLSecurity;\nexports.ClientSSLSecurityPFX = security.ClientSSLSecurityPFX;\nexports.BearerSecurity = security.BearerSecurity;\nexports.createClient = createClient;\nexports.passwordDigest = passwordDigest;\nexports.listen = listen;\nexports.WSDL = WSDL;\n\n// Export Client and Server to allow customization\nexports.Server = Server;\nexports.Client = Client;\nexports.HttpClient = HttpClient;\n\nvar soap = {\n  createClient: createClient\n}\nexport default soap;"]}