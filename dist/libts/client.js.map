{"version":3,"sources":["../../libts/client.ts"],"names":[],"mappings":"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","file":"client.js","sourceRoot":"","sourcesContent":["import { findPrefix } from './utils'\nimport * as _ from 'lodash';\nimport * as assert from 'assert';\nimport * as uuid from 'uuid';\nimport { WSDL } from \"./wsdl\";\n\nexport class Client {\n  lastResponseHeaders: any;\n  lastResponse: string;\n  endpoint: any;\n  bodyAttributes: any;\n  lastRequestHeaders: any;\n  lastEndpoint: any;\n  lastRequest: any;\n  lastMessage: string;\n  security: any;\n  httpHeaders: any;\n  streamAllowed: any;\n  SOAPAction: any;\n  soapHeaders: any;\n  wsdl: WSDL;\n\n  constructor(wsdl: WSDL, endpoint?: any, options?: any) {\n    options = options || {};\n    this.wsdl = wsdl;\n    this._initializeOptions(options);\n    this._initializeServices(endpoint);\n  }\n\n  addSoapHeader(soapHeader: any, name: any, namespace: any, xmlns: any) {\n    if (!this.soapHeaders) {\n      this.soapHeaders = [];\n    }\n    if (typeof soapHeader === 'object') {\n      soapHeader = this.wsdl.objectToXML(soapHeader, name, namespace, xmlns, true);\n    }\n    return this.soapHeaders.push(soapHeader) - 1;\n  }\n\n  changeSoapHeader(index: any, soapHeader: any, name: any, namespace: any, xmlns: any) {\n    if (!this.soapHeaders) {\n      this.soapHeaders = [];\n    }\n    if (typeof soapHeader === 'object') {\n      soapHeader = this.wsdl.objectToXML(soapHeader, name, namespace, xmlns, true);\n    }\n    this.soapHeaders[index] = soapHeader;\n  }\n\n  getSoapHeaders() {\n    return this.soapHeaders;\n  }\n\n  clearSoapHeaders() {\n    this.soapHeaders = null;\n  }\n\n  addHttpHeader(name: any, value: any) {\n    if (!this.httpHeaders) {\n      this.httpHeaders = {};\n    }\n    this.httpHeaders[name] = value;\n  }\n\n  getHttpHeaders() {\n    return this.httpHeaders;\n  }\n\n  clearHttpHeaders() {\n    this.httpHeaders = {};\n  }\n\n  addBodyAttribute(bodyAttribute: any, name: any, namespace: any, xmlns: any) {\n    if (!this.bodyAttributes) {\n      this.bodyAttributes = [];\n    }\n    if (typeof bodyAttribute === 'object') {\n      var composition = '';\n      Object.getOwnPropertyNames(bodyAttribute).forEach(function (prop, idx, array) {\n        composition += ' ' + prop + '=\"' + bodyAttribute[prop] + '\"';\n      });\n      bodyAttribute = composition;\n    }\n    if (bodyAttribute.substr(0, 1) !== ' ') bodyAttribute = ' ' + bodyAttribute;\n    this.bodyAttributes.push(bodyAttribute);\n  }\n\n  getBodyAttributes() {\n    return this.bodyAttributes;\n  }\n\n  clearBodyAttributes() {\n    this.bodyAttributes = null;\n  }\n\n  setEndpoint(endpoint: any) {\n    this.endpoint = endpoint;\n    this._initializeServices(endpoint);\n  }\n\n  describe () {\n    var types = this.wsdl.definitions.types;\n    return this.wsdl.describeServices();\n  }\n\n  setSecurity(security: any) {\n    this.security = security;\n  }\n\n  setSOAPAction(SOAPAction: any) {\n    this.SOAPAction = SOAPAction;\n  }\n\n  private _initializeServices(endpoint: any) {\n    var definitions = this.wsdl.definitions,\n      services = definitions.services;\n    for (var name in services) {\n      (this as any)[name] = this._defineService(services[name], endpoint);\n    }\n  }\n\n  private _initializeOptions(options: any = {}) {\n    this.streamAllowed = options.stream;\n    this.wsdl.options.attributesKey = options.attributesKey || 'attributes';\n    this.wsdl.options.envelopeKey = options.envelopeKey || 'soap';\n    if (options.ignoredNamespaces !== undefined) {\n      if (options.ignoredNamespaces.override !== undefined) {\n        if (options.ignoredNamespaces.override === true) {\n          if (options.ignoredNamespaces.namespaces !== undefined) {\n            this.wsdl.options.ignoredNamespaces = options.ignoredNamespaces.namespaces;\n          }\n        }\n      }\n    }\n    if (options.overrideRootElement !== undefined) {\n      this.wsdl.options.overrideRootElement = options.overrideRootElement;\n    }\n    this.wsdl.options.forceSoap12Headers = !!options.forceSoap12Headers;\n  }\n\n  private _defineService(service: any, endpoint: any) {\n    var ports = service.ports,\n      def: any = {};\n    for (var name in ports) {\n      def[name] = this._definePort(ports[name], endpoint ? endpoint : ports[name].location);\n    }\n    return def;\n  }\n\n  private _definePort(port: any, endpoint: any) {\n    var location = endpoint,\n      binding = port.binding,\n      methods = binding.methods,\n      def: any = {};\n    for (var name in methods) {\n      def[name] = this._defineMethod(methods[name], location);\n      (this as any)[name] = def[name];\n    }\n    return def;\n  }\n\n  private _defineMethod(method: any, location: any) {\n    var self = this;\n    var temp;\n    return function (args: any, callback: any, options: any, extraHeaders: any) {\n      if (typeof args === 'function') {\n        callback = args;\n        args = {};\n      } else if (typeof options === 'function') {\n        temp = callback;\n        callback = options;\n        options = temp;\n      } else if (typeof extraHeaders === 'function') {\n        temp = callback;\n        callback = extraHeaders;\n        extraHeaders = options;\n        options = temp;\n      }\n      self._invoke(method, args, location, function (error: any, result: any, raw: any, soapHeader: any) {\n        callback(error, result, raw, soapHeader);\n      }, options, extraHeaders);\n    };\n  }\n\n  private _invoke(method: any, args: any, location: any, callback: any, options: any, extraHeaders: any) {\n    var self = this,\n      name = method.$name,\n      input = method.input,\n      output = method.output,\n      style = method.style,\n      defs = this.wsdl.definitions,\n      envelopeKey = this.wsdl.options.envelopeKey,\n      ns = defs.$targetNamespace,\n      encoding = '',\n      message = '',\n      xml = null,\n      req:any = null,\n      soapAction,\n      alias = findPrefix(defs.xmlns, ns),\n      headers: any = {\n        \"Content-Type\": \"text/xml; charset=utf-8\"\n      },\n      xmlnsSoap = \"xmlns:\" + envelopeKey + \"=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\"\";\n\n    if (this.wsdl.options.forceSoap12Headers) {\n      headers[\"Content-Type\"] = \"application/soap+xml; charset=utf-8\";\n      xmlnsSoap = \"xmlns:\" + envelopeKey + \"=\\\"http://www.w3.org/2003/05/soap-envelope\\\"\";\n    }\n\n    if (this.SOAPAction) {\n      soapAction = this.SOAPAction;\n    } else if (method.soapAction !== undefined && method.soapAction !== null) {\n      soapAction = method.soapAction;\n    } else {\n      soapAction = ((ns.lastIndexOf(\"/\") !== ns.length - 1) ? ns + \"/\" : ns) + name;\n    }\n\n    if (!this.wsdl.options.forceSoap12Headers) {\n      headers.SOAPAction = '\"' + soapAction + '\"';\n    }\n\n    options = options || {};\n\n    //Add extra headers\n    for (var header in this.httpHeaders) { headers[header] = this.httpHeaders[header]; }\n    for (var attr in extraHeaders) { headers[attr] = extraHeaders[attr]; }\n\n    // Allow the security object to add headers\n    if (this.security && this.security.addHeaders)\n      self.security.addHeaders(headers);\n    if (this.security && this.security.addOptions)\n      self.security.addOptions(options);\n\n    if ((style === 'rpc') && ((input.parts || input.name === \"element\") || args === null)) {\n      assert.ok(!style || style === 'rpc', 'invalid message definition for document style binding');\n      message = self.wsdl.objectToRpcXML(name, args, alias, ns, (input.name !== \"element\"));\n      (method.inputSoap === 'encoded') && (encoding = 'soap:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\" ');\n    } else {\n      assert.ok(!style || style === 'document', 'invalid message definition for rpc style binding');\n      // pass `input.$lookupType` if `input.$type` could not be found\n      message = self.wsdl.objectToDocumentXML(input.$name, args, input.targetNSAlias, input.targetNamespace, (input.$type || input.$lookupType));\n    }\n    xml = \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\" +\n      \"<\" + envelopeKey + \":Envelope \" +\n      xmlnsSoap + \" \" +\n      \"xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" \" +\n      encoding +\n      this.wsdl.xmlnsInEnvelope + '>' +\n      ((self.soapHeaders || self.security) ?\n        (\n          \"<\" + envelopeKey + \":Header>\" +\n          (self.soapHeaders ? self.soapHeaders.join(\"\\n\") : \"\") +\n          (self.security && !self.security.postProcess ? self.security.toXML() : \"\") +\n          \"</\" + envelopeKey + \":Header>\"\n        )\n        :\n        ''\n      ) +\n      \"<\" + envelopeKey + \":Body\" +\n      (this.bodyAttributes ? this.bodyAttributes.join(' ') : '') +\n      (this.security && this.security.postProcess ? ' Id=\"_0\"' : '') +\n      \">\" +\n      message +\n      \"</\" + envelopeKey + \":Body>\" +\n      \"</\" + envelopeKey + \":Envelope>\";\n\n    if (self.security && self.security.postProcess) {\n      xml = self.security.postProcess(xml, envelopeKey);\n    }\n\n    this.lastMessage = message;\n    this.lastRequest = xml;\n    this.lastEndpoint = location;\n\n    var eid = options.exchangeId || uuid.v4();\n\n    var tryJSONparse = function (body: any) {\n      try {\n        return JSON.parse(body);\n      }\n      catch (err) {\n        return undefined;\n      }\n    };\n\n    this.wsdl.http.post(location, xml, {}).map(response => {\n      let body = response.text();\n      this.lastResponse = body;\n      this.lastResponseHeaders = response.headers;\n      parseSync(body, response);\n    });\n\n    // if (this.streamAllowed && typeof self.httpClient.requestStream === 'function') {\n    //   callback = _.once(callback);\n    //   var startTime = Date.now();\n    //   req = this.httpClient.requestStream(location, xml, headers, options, self);\n    //   this.lastRequestHeaders = req.headers;\n    //   var onError = function onError(err) {\n    //     self.lastResponse = null;\n    //     self.lastResponseHeaders = null;\n    //     self.lastElapsedTime = null;\n    //     self.emit('response', null, null, eid);\n\n    //     callback(err);\n    //   };\n    //   req.on('error', onError);\n    //   req.on('response', function (response) {\n    //     response.on('error', onError);\n\n    //     // When the output element cannot be looked up in the wsdl, play it safe and\n    //     // don't stream\n    //     if (response.statusCode !== 200 || !output || !output.$lookupTypes) {\n    //       response.pipe(concatStream({ encoding: 'string' }, function (body) {\n    //         self.lastResponse = body;\n    //         self.lastResponseHeaders = response && response.headers;\n    //         self.lastElapsedTime = Date.now() - startTime;\n    //         self.emit('response', body, response, eid);\n\n    //         return parseSync(body, response);\n\n    //       }));\n    //       return;\n    //     }\n\n    //     self.wsdl.xmlToObject(response, function (error, obj) {\n    //       self.lastResponse = response;\n    //       self.lastResponseHeaders = response && response.headers;\n    //       self.lastElapsedTime = Date.now() - startTime;\n    //       self.emit('response', '<stream>', response, eid);\n\n    //       if (error) {\n    //         error.response = response;\n    //         error.body = '<stream>';\n    //         self.emit('soapError', error, eid);\n    //         return callback(error, response);\n    //       }\n\n    //       return finish(obj, '<stream>', response);\n    //     });\n    //   });\n    //   return;\n    // }\n\n    // req = th.httpClient.request(location, xml, function (err, response, body) {\n    //   self.lastResponse = body;\n    //   self.lastResponseHeaders = response && response.headers;\n    //   self.lastElapsedTime = response && response.elapsedTime;\n    //   self.emit('response', body, response, eid);\n\n    //   if (err) {\n    //     callback(err);\n    //   } else {\n    //     return parseSync(body, response);\n    //   }\n    // }, headers, options, self);\n\n    function parseSync(body: any, response: any) {\n      var obj;\n      try {\n        obj = self.wsdl.xmlToObject(body);\n      } catch (error) {\n        //  When the output element cannot be looked up in the wsdl and the body is JSON\n        //  instead of sending the error, we pass the body in the response.\n        if (!output || !output.$lookupTypes) {\n          //  If the response is JSON then return it as-is.\n          var json = _.isObject(body) ? body : tryJSONparse(body);\n          if (json) {\n            return callback(null, response, json);\n          }\n        }\n        error.response = response;\n        error.body = body;\n\n        return callback(error, response, body);\n      }\n      return finish(obj, body, response);\n    }\n\n    function finish(obj:any, body:any, response:any) {\n      var result;\n\n      if (!output) {\n        // one-way, no output expected\n        return callback(null, null, body, obj.Header);\n      }\n\n      if (typeof obj.Body !== 'object') {\n        var error: any = new Error('Cannot parse response');\n        error.response = response;\n        error.body = body;\n        return callback(error, obj, body);\n      }\n\n      // if Soap Body is empty\n      if (!obj.Body) {\n        return callback(null, obj, body, obj.Header);\n      }\n\n      result = obj.Body[output.$name];\n      // RPC/literal response body may contain elements with added suffixes I.E.\n      // 'Response', or 'Output', or 'Out'\n      // This doesn't necessarily equal the ouput message name. See WSDL 1.1 Section 2.4.5\n      if (!result) {\n        result = obj.Body[output.$name.replace(/(?:Out(?:put)?|Response)$/, '')];\n      }\n      if (!result) {\n        ['Response', 'Out', 'Output'].forEach(function (term) {\n          if (obj.Body.hasOwnProperty(name + term)) {\n            return result = obj.Body[name + term];\n          }\n        });\n      }\n\n      callback(null, result, body, obj.Header);\n    }\n\n    // Added mostly for testability, but possibly useful for debugging\n    if (req && req.headers) //fixes an issue when req or req.headers is indefined\n      this.lastRequestHeaders = req.headers;\n  }\n\n}"]}